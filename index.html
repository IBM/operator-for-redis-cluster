<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">Home | Operator for Redis Cluster</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://ibm.github.io/operator-for-redis-cluster/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Home | Operator for Redis Cluster"><meta data-react-helmet="true" name="description" content="logo"><meta data-react-helmet="true" property="og:description" content="logo"><link data-react-helmet="true" rel="icon" href="/operator-for-redis-cluster/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://ibm.github.io/operator-for-redis-cluster/"><link data-react-helmet="true" rel="alternate" href="https://ibm.github.io/operator-for-redis-cluster/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://ibm.github.io/operator-for-redis-cluster/" hreflang="x-default"><script data-react-helmet="true">function maybeInsertBanner(){window.__DOCUSAURUS_INSERT_BASEURL_BANNER&&insertBanner()}function insertBanner(){var n=document.getElementById("docusaurus-base-url-issue-banner-container");if(n){n.innerHTML='\n<div id="docusaurus-base-url-issue-banner" style="border: thick solid red; background-color: rgb(255, 230, 179); margin: 20px; padding: 20px; font-size: 20px;">\n   <p style="font-weight: bold; font-size: 30px;">Your Docusaurus site did not load properly.</p>\n   <p>A very common reason is a wrong site <a href="https://docusaurus.io/docs/docusaurus.config.js/#baseurl" style="font-weight: bold;">baseUrl configuration</a>.</p>\n   <p>Current configured baseUrl = <span style="font-weight: bold; color: red;">/operator-for-redis-cluster/</span> </p>\n   <p>We suggest trying baseUrl = <span id="docusaurus-base-url-issue-banner-suggestion-container" style="font-weight: bold; color: green;"></span></p>\n</div>\n';var e=document.getElementById("docusaurus-base-url-issue-banner-suggestion-container"),r=window.location.pathname,s="/"===r.substr(-1)?r:r+"/";e.innerHTML=s}}window.__DOCUSAURUS_INSERT_BASEURL_BANNER=!0,document.addEventListener("DOMContentLoaded",maybeInsertBanner)</script><link rel="stylesheet" href="/operator-for-redis-cluster/assets/css/styles.488c9a18.css">
<link rel="preload" href="/operator-for-redis-cluster/assets/js/runtime~main.74806389.js" as="script">
<link rel="preload" href="/operator-for-redis-cluster/assets/js/main.c195b2d0.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div id="docusaurus-base-url-issue-banner-container"></div><div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/operator-for-redis-cluster/"><div class="navbar__logo"><img src="/operator-for-redis-cluster/images/logo.svg" alt="Operator for Redis Cluster" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/operator-for-redis-cluster/images/logo.svg" alt="Operator for Redis Cluster" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Operator for Redis Cluster</b></a></div><div class="navbar__items navbar__items--right"><a href="https://ibm.github.io/operator-for-redis-cluster" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleChecked_a04y toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" checked="" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/operator-for-redis-cluster/">Home</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/operator-for-redis-cluster/cookbook">Cookbook</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/operator-for-redis-cluster/kubectl-plugin">Kubectl Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/operator-for-redis-cluster/configuration">Redis Server Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/operator-for-redis-cluster/scaling">Scaling Operations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/operator-for-redis-cluster/rolling-update">Rolling Update Procedure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/operator-for-redis-cluster/key-migration">Key Migration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/operator-for-redis-cluster/contributing">Contributing</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><p><img alt="logo" src="/operator-for-redis-cluster/assets/images/logo-34d5aecd76e632e1a7d7bc9e9d9d7c67.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="project-status-alpha">Project status: alpha<a class="hash-link" href="#project-status-alpha" title="Direct link to heading">â€‹</a></h2><p>This is an ongoing project.</p><p>The goal of this project is to simplify the deployment and management of a <a href="https://redis.io/topics/cluster-tutorial" target="_blank" rel="noopener noreferrer">Redis cluster</a> in a <a href="https://kubernetes.io/" target="_blank" rel="noopener noreferrer">Kubernetes</a> environment. It started internally at Amadeus in 2016, where it was initially designed to run on <a href="https://www.openshift.com/" target="_blank" rel="noopener noreferrer">Openshift</a>. This is the third version of the Redis operator, which leverages the <a href="https://sdk.operatorframework.io/" target="_blank" rel="noopener noreferrer">Operator SDK</a> framework for operators.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="overview">Overview<a class="hash-link" href="#overview" title="Direct link to heading">â€‹</a></h2><p>This project contains two Helm charts, namely <code>operator-for-redis</code> and <code>node-for-redis</code>. The first chart deploys the Redis operator, <code>RedisCluster</code> Custom Resource Definition (CRD), and various other k8s resources. The second chart deploys the <code>RedisCluster</code> resource and various other k8s resources. Each node in the Redis cluster runs in its own Pod. Upon startup, each node joins the cluster as a primary node with no slots. See the cluster representation in the diagram below:</p><p><img alt="Initial state" src="/operator-for-redis-cluster/assets/images/overview_1-87d24b48af2c162cd54641cd2424229d.png"></p><p>At this point, your Redis process is running and each node is aware of each other, but only one primary has all the slots. In order to properly configure each node in the cluster, we introduce the <code>Operator for Redis Cluster</code>.</p><p>The operator watches the <code>RedisCluster</code> CR that stores cluster configuration: number of primaries, replication factor (number of replicas per primary), and the pod template. Then the operator tries to apply this configuration to the set of Redis server processes. If the number of Redis servers doesn&#x27;t match the provided configuration, the manager scales the number of pods to obtain the proper number of Redis nodes. The operator continuously reconciles the state of the cluster with the configuration stored in the <code>RedisCluster</code> CR until they match. To understand how the reconciliation loop works, see the <a href="https://sdk.operatorframework.io/docs/building-operators/golang/tutorial/#reconcile-loop" target="_blank" rel="noopener noreferrer">Operator SDK docs</a>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="deployment">Deployment<a class="hash-link" href="#deployment" title="Direct link to heading">â€‹</a></h2><p>You can follow the <a href="/operator-for-redis-cluster/cookbook">cookbook</a> to deploy the operator and Redis cluster with Minikube.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="environment-requirements">Environment requirements<a class="hash-link" href="#environment-requirements" title="Direct link to heading">â€‹</a></h3><p>The project may have started on Openshift, but it now supports Kubernetes as well. Please check the minimum environment version in the table below.</p><table><thead><tr><th>Environment</th><th>Version</th></tr></thead><tbody><tr><td>Openshift</td><td>&gt;= 3.7</td></tr><tr><td>Kubernetes</td><td>&gt;= 1.7</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="helm-chart-deployment">Helm chart deployment<a class="hash-link" href="#helm-chart-deployment" title="Direct link to heading">â€‹</a></h3><p>You can find two Helm charts in the <code>charts</code> folder:</p><ul><li><code>operator-for-redis</code> used to deploy the operator in your Kubernetes cluster.</li><li><code>node-for-redis</code> used to create the <code>RedisCluster</code> CR that will be managed by the operator.</li></ul><p>Operator deployment example:</p><div class="codeBlockContainer_J+bg language-console theme-code-block"><div class="codeBlockContent_csEI console"><pre tabindex="0" class="prism-code language-console codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm install operator-for-redis charts/operator-for-redis</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAME: operator-for-redis</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">LAST DEPLOYED: Fri Aug 13 11:48:29 2021</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAMESPACE: default</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">STATUS: deployed</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RESOURCES:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">==&gt; v1/Deployment</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAME                DESIRED  CURRENT  UP-TO-DATE  AVAILABLE  AGE</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">operator-for-redis  1        1        1           1          10s</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="create-the-rediscluster">Create the RedisCluster<a class="hash-link" href="#create-the-rediscluster" title="Direct link to heading">â€‹</a></h4><p>You can configure the topology of the cluster by editing the provided <code>values.yaml</code>, using an override file, and/or setting each value with <code>--set</code> when you execute <code>helm install</code>.</p><p>Redis cluster deployment example:</p><div class="codeBlockContainer_J+bg language-console theme-code-block"><div class="codeBlockContent_csEI console"><pre tabindex="0" class="prism-code language-console codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm install node-for-redis charts/node-for-redis</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAME: node-for-redis</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">LAST DEPLOYED: Fri Aug 13 11:48:29 2021</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAMESPACE: default</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">STATUS: deployed</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">REVISION: 1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">TEST SUITE: None</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><blockquote><p><strong>! Warning !</strong>, if you want to use the docker images corresponding to the level of code present in the &quot;main&quot; branch. You need to set the image tag when you instantiate the node-for-redis chart and the operator-for-redis-cluster chart. The &quot;latest&quot; tag is corresponding to the last validated release.</p></blockquote><div class="codeBlockContainer_J+bg language-console theme-code-block"><div class="codeBlockContent_csEI console"><pre tabindex="0" class="prism-code language-console codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">helm install node-for-redis charts/node-for-redis --set image.tag=main-$COMMIT-dev</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="install-kubectl-redis-cluster-plugin">Install kubectl redis-cluster plugin<a class="hash-link" href="#install-kubectl-redis-cluster-plugin" title="Direct link to heading">â€‹</a></h3><p>Docs available <a href="/operator-for-redis-cluster/kubectl-plugin">here</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="deployment-from-source-code">Deployment from source code<a class="hash-link" href="#deployment-from-source-code" title="Direct link to heading">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_y2LR" id="build-container-images">Build container images<a class="hash-link" href="#build-container-images" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_J+bg language-console theme-code-block"><div class="codeBlockContent_csEI console"><pre tabindex="0" class="prism-code language-console codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cd $GOPATH/src/github.com/IBM/operator-for-redis-cluster</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">make container</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>you can define the docker images tag by adding the variable &quot;TAG&quot;</p><div class="codeBlockContainer_J+bg language-console theme-code-block"><div class="codeBlockContent_csEI console"><pre tabindex="0" class="prism-code language-console codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">make TAG=&lt;Your-TAG&gt; container</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="how-to-release-the-redis-operator">How to Release the Redis Operator<a class="hash-link" href="#how-to-release-the-redis-operator" title="Direct link to heading">â€‹</a></h3><blockquote><p>Do the following in <code>main</code> branch:</p><ol><li>Create a tag on commit</li><li>Push the commit and tag</li><li>Github actions automation will build and push docker images and helm charts with release version</li></ol><p>NOTE: If you need to test the build prior to the above steps, you can run: <code>make build</code> and resolve any issues.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_y2LR" id="how-to-upgrade-redis-client-version">How to Upgrade Redis Client Version<a class="hash-link" href="#how-to-upgrade-redis-client-version" title="Direct link to heading">â€‹</a></h3><p>To upgrade your Redis client version, you will need to update the <code>REDIS_VERSION</code> variable in both the Dockerfile for Redis node and the Github release workflow. Please note that upgrading the Redis client version may impact functionality because the operator depends on the <a href="https://github.com/mediocregopher/radix" target="_blank" rel="noopener noreferrer">radix library</a> for executing Redis commands.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://ibm.github.io/operator-for-redis-cluster/docs/home.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-07-13T19:32:24.000Z">7/13/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/operator-for-redis-cluster/cookbook"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Cookbook</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#project-status-alpha" class="table-of-contents__link toc-highlight">Project status: alpha</a></li><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#deployment" class="table-of-contents__link toc-highlight">Deployment</a><ul><li><a href="#environment-requirements" class="table-of-contents__link toc-highlight">Environment requirements</a></li><li><a href="#helm-chart-deployment" class="table-of-contents__link toc-highlight">Helm chart deployment</a></li><li><a href="#install-kubectl-redis-cluster-plugin" class="table-of-contents__link toc-highlight">Install kubectl redis-cluster plugin</a></li><li><a href="#deployment-from-source-code" class="table-of-contents__link toc-highlight">Deployment from source code</a></li><li><a href="#how-to-release-the-redis-operator" class="table-of-contents__link toc-highlight">How to Release the Redis Operator</a></li><li><a href="#how-to-upgrade-redis-client-version" class="table-of-contents__link toc-highlight">How to Upgrade Redis Client Version</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Operator for Redis Cluster Documentation. Built with Docusaurus.</div></div></div></footer></div>
<script src="/operator-for-redis-cluster/assets/js/runtime~main.74806389.js"></script>
<script src="/operator-for-redis-cluster/assets/js/main.c195b2d0.js"></script>
</body>
</html>